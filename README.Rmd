---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# DependencyReviewer

<!-- badges: start -->
[![Lifecycle:Experimental](https://img.shields.io/badge/Lifecycle-Experimental-339999)](https://www.tidyverse.org/lifecycle/#experimental)
<!-- badges: end -->


## Installation

You can install the development version of DependencyReviewer like so:
``` r
install.packages("remotes")
remotes::install_github("darwin-eu/DependencyReviewer")
```


## Example
Check whether dependencies in the description file are approved and whether the required version matches the current recommendation.
```{r}
library(DependencyReviewer)
library(CodelistGenerator)
library(dplyr)
library(ggplot2)
```

Without any options set, it will review the package you are currently inside:
```{r}
checkDependencies()
```

```{r}
r_files <- list.files(here::here("R"))

function_use <- summariseFunctionUse(r_files)

head(function_use)
```

```{r}
function_sub <- function_use %>% 
  filter(pkg != "unknown") %>% 
  filter(pkg != "base") %>% 
  filter(pkg != "methods")

fun_counts <- function_sub %>% group_by(fun, pkg, name = "n") %>% tally()

ggplot(
  data = fun_counts, 
  mapping = aes(x = fun, y = n, fill = pkg)) +
  geom_col() +
  facet_wrap(
    vars(pkg), 
    scales = "free_x", 
    ncol=2) +
  theme_bw() +
  theme(
    legend.position = "none",
    axis.text.x = (element_text(angle = 45, hjust = 1, vjust = 1)))
```

## ShinyApp

Dependency Reviewer now includes a shiny app, which encapsulates all the 
functionality available in the package. The app consist of two sections:

1. Function Review (Function Review and Plot tab)

![Function Review](man/figures/function_review.png)
![Function Review](man/figures/plot.png)


2. Dependency Graph (Dependency Graph tab)

![Dependency Graph](man/figures/dependency_graph.png)
